# Generalized Rational Variable Projection With Application in ECG Compression [1] <br/><sub>*( Péter Kovács, Sándor Fridli & Ferenc Schipp )*</sub>

This repository is a translation from matlab. The original code can be viewed on Codeocean, [here.](https://codeocean.com/capsule/0308835/tree/v1) <br/>
Subordinate translators: Örs Takács & Nguyen Thac Bach

![Tests](https://github.com/Denotron/Generalized-Rational-Variable-Projection-with-Application-in-ECG-Compression/actions/workflows/tests.yml/badge.svg)

## Structure of the Python Toolbox
```
/ [root]
├── code
│   ├── Adaptive_Wavelets
│   ├── B-spline
│   ├── Hermite
│   ├── Rational
│   │   ├── with_numpy
│   │   └── with_torch
│   │       └── [python scripts]
│   │ 
│   └── [VarPro_demos.pdf]
│
├── data
│   └── [ecg data]
│
├── results
│   └── [saved figures]
│   
└── tests
    └── [test files]
```

- **Code** contains various algorithms for approximating ECG signals using adaptive wavelets [2], B-splines [3], Hermite functions [4], and rational functions [5]. Each directory contains an *example.py* script, which demonstrates the algorithms step by step. These demonstrations are also available in pdf format. The animations in *VarPro_demos.pdf* work in Adobe Acrobat Reader.
- **Data** some real ECG signals are stored in this directory.
- **Results** includes the figures generated by the scripts.

## Differences compared to the original repository
- The Adaptive Wavelets package contains the implementation of Adaptive Wavelet Transform (AWT),<br/>
but not the Adaptive Wavelet **Packet** Transform (AWPT)
- The Orthogonal Rational functions are implemented both with Numpy and PyTorch.<br/>
If an nVidia GPU is not available, the Numpy implementation is expected to achieve better runspeeds for the same result.
- Testfiles are available for most functions, however the more important ones are tested with *example.py* files in their corresponding package. <br/>
**[Notice]** This repository only offers testing for those functions within <br/>
[*Rational/with_torch/rait/...*], which are crucial to the functioning of MDHPSO (hyp_mdpso.py)

## References 

> [1] Kovács, P., Fridli, S., Schipp, F., Generalized Rational Variable Projection With Application in ECG Compression, IEEE Transactions on Signal Processing, 2020, vol. 68, pp. 478-492.

> [2] L. Brechet, M. F. Lucas, C. Doncarli, and D. Farina, Compression of biomedical signals with mother wavelet optimization and best-basis wavelet packet selection, IEEE Transactions Biomedical Engineering, vol. 54, no. 12, pp. 2186–2192, 2007.

> [3] M. Karczewicz and M. Gabbouj, ECG data compression by spline approximation, Signal Processing, vol. 59, pp. 43–59, 1997.

> [4] A. Sandryhaila, S. Saba, M. Püschel, and J. Kovacevic, Efficient compression of QRS complexes using Hermite expansion, IEEE Transactions Signal Processing, vol. 60, no. 2, pp. 947–955, Feb. 2012.

> [5] Kovács, P., Transformation methods in signal processing, PhD Thesis, Eötvös L. University, 2016.
