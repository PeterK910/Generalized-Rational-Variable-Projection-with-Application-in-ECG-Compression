from B_spline.predict_mse import predict_mse
import numpy as np


def test_1():
    psig=np.array([0,-0.03049,-0.030165,-0.076061,-0.029514,-0.060004,0.032765,0.079312,0.079637,0.157,0.15732,0.12683,0.080937,0.096669,0.096994,0.081912,0.11305,0.12878,0.20615,0.12943,0.19139,0.20712,0.22285,0.19236,0.17728,0.1622,0.19334,0.16285,0.10155,0.14809,0.21005,0.19496,0.2261,0.24184,0.21135,0.25789,0.15037,0.13529,0.1048,0.074306,0.074631,0.028734,0.059874,0.091014,0.091339,0.13789,0.076581,0.061499,0.077232,0.062149,0.047067,0.031985,0.047717,0.094264,0.079182,0.12573,0.18768,0.15719,0.20374,0.20407,0.12735,0.11227,0.050968,0.035885,0.020803,0.051943,0.036861,0.068,0.068325,0.053243,0.038161,0.053893,0.023403,-0.022493,-0.006761,0.0089713,-0.06774,-0.0057859,-0.0054608,0.010272,-0.0048107,0.026329,0.057469,0.026979,0.027304,-0.034,-0.06449,-0.03335,-0.06384,-0.10974,-0.032375,-0.016642,-0.00091014,0.061044,0.045962,0.015472,-0.015017,0.00071511,-0.045182,-0.029449,-0.059939,0.0020153,0.048562,0.079702,0.14166,0.14198,0.15771,0.18885,0.21999,0.25113,0.31309,0.35963,0.51403,0.62221,0.68416,0.60745,0.37667,-0.039006,-0.5009,-0.96279,-1.4863,-1.9944,-2.5334,-3.2264,-3.9194,-4.5353,-5.1359,-5.5208,-5.6899,-5.8128,-5.8433,-5.8892,-5.8735,-5.8732,-5.8728,-5.8109,-5.6257,-5.3942,-5.0396,-4.7465,-4.4534,-4.145,-3.8981,-3.6205,-3.312,-3.1114,-2.9107,-2.7255,-2.4633,-2.2318,-1.9388,-1.6457,-1.4143,-1.0904,-0.7049,-0.39643,-0.11877,0.081847,0.15921,0.12872,0.15986,0.17559,0.28377,0.34572,0.48471,0.54667,0.67025,0.70139,0.65549,0.71745,0.65614,0.67188,0.70302,0.70334,0.76529,0.79643,0.90461,0.95116,0.93607,0.9364,0.98295,0.93705,0.95278,0.98392,0.99965,1.0462,1.0773,1.1855,1.2167,1.3402,1.3714,1.4487,1.4645,1.511,1.5422,1.5425,1.5736,1.7126,1.79,1.8827,1.9293,2.0375,2.1456,2.1614,2.2079,2.162,2.1778,2.1627,2.1322,2.1787,2.1945,2.2102,2.2722,2.3495,2.4577,2.5659,2.6278,2.5665,2.6439,2.6288,2.6908,2.7989,2.8455,2.892,3.031,3.0005,3.0471,2.9704,2.8936,2.8478,2.8019,2.756,2.7255,2.6642,2.6337,2.6032,2.5111,2.496,2.3422,2.2655,2.1426,2.0042,1.8967,1.743,1.62,1.4817,1.4204,1.3591,1.2362,1.1749,1.0365,0.9444,0.83687,0.74475,0.591,0.56051,0.46839,0.4225,0.36119,0.40774,0.36184,0.37758,0.34709,0.332,0.30152,0.28643,0.19431,0.17923,0.13333,0.16447,0.18021,0.21135,0.21167,0.28903,0.28936,0.25887,0.30542,0.24411,0.22903,0.21395,0.21427,0.18378,0.23033,0.23065,0.2772,0.30834,0.32407,0.30899,0.29391,0.27883,0.26374,0.18703,0.17195,0.18768,0.21882,0.24996,0.25029,0.29683,0.34338,0.31289,0.26699,0.25191,0.28305,0.19093,0.25289,0.19158,0.23813,0.28468,0.285,0.31614,0.30106,0.27057,0.2863,0.17878,0.16369,0.16402,0.17975,0.13385,0.14959,0.21154,0.22727,0.27382,0.25874,0.24366,0.21317,0.18268,0.19841,0.10629,0.10662,0.076126,0.10727,0.13841,0.13873,0.20068,0.1702,0.1243,0.10922,0.094134,0.094459,0.06397,0.048887,0.049212,0.095759,0.11149,0.12722,0.14296,0.12787,0.15901,0.12852,0.082627,0.082952,0.0062409,0.052788,0.022298,0.038031,0.06917,0.069495,0.10064,0.10096,0.0088413,0.070796,0.024899,-0.036405,-0.0052658,-0.0049407,-0.0046157,0.072746,0.057664,0.073396,0.073721,0.10486,0.10519,0.028474,0.013392,0.059939,-0.0013652,-0.016447,-0.03153,-0.00039006,-6.501e-05,0.046482,0.062214,0.031725,0.062864,0.032375,0.017293,0.017618,-0.012872,-0.012547,-0.012222,-0.011897,0.050057,0.081197,0.11234,0.11266,0.082172,0.082497,0.0366,0.021518,-0.024379,-0.039461,-0.06995,-0.023403,-0.038486,0.023469,0.054608,-0.006696,0.055258,0.055583,0.0096864,-0.0053958,0.010337,-0.066375,-0.0044207,-0.050318,0.027044,0.027369,0.058509,0.028019,0.028344,-0.0021453,-0.048042,-0.063124,-0.13984,-0.093289,-0.10837,-0.12345,-0.10772,0.00045507,0.016187,0.016512,0.032245,0.0017553,0.017488,-0.074631,-0.12053,-0.13561,-0.11988,-0.10415,-0.073006,-0.057274,-0.087763,-0.010402,-0.025484,-0.025159,-0.086463,-0.086138,-0.16285,-0.19334,-0.17761,-0.10024,-0.053698,0.0082562,0.023989,0.055128,0.0092314,0.071186,-0.020933,-0.06683,-0.11273,-0.096994,-0.065855,-0.034715,-0.049797,-0.0032505,0.043296,0.012807,-0.048497,0.013457,-0.047847,-0.047522,-0.12423,-0.1085,-0.092769,0])
    s=np.array([0,-0.02805,-0.038303,-0.057311,-0.061673,-0.027246,0.023136,0.063372,0.10127,0.14374,0.1602,0.12728,0.08802,0.085527,0.096656,0.094339,0.10202,0.14123,0.17529,0.17119,0.16878,0.20461,0.22919,0.19673,0.16199,0.17818,0.1916,0.15003,0.11438,0.14635,0.19801,0.21359,0.21559,0.23299,0.24252,0.21802,0.17426,0.13268,0.1006,0.079627,0.062548,0.04579,0.049098,0.085371,0.11679,0.10797,0.083986,0.074976,0.070773,0.057116,0.043634,0.042608,0.053022,0.071316,0.097024,0.1292,0.16188,0.18751,0.1973,0.18425,0.14975,0.10044,0.055467,0.032272,0.028981,0.038407,0.051421,0.060081,0.063126,0.060531,0.050521,0.032946,0.015896,0.0057198,-0.0064242,-0.026759,-0.03583,-0.017938,0.0019306,0.00041033,0.0013236,0.027483,0.050477,0.039895,0.0085555,-0.02312,-0.047514,-0.061746,-0.06906,-0.071243,-0.058124,-0.022507,0.018941,0.045893,0.047242,0.020861,-0.0086809,-0.019356,-0.026012,-0.042971,-0.045558,-0.0099146,0.045567,0.095568,0.12931,0.14456,0.15871,0.18771,0.22203,0.25281,0.29927,0.3819,0.49809,0.6257,0.68751,0.60704,0.36588,-0.025273,-0.49739,-0.98232,-1.4739,-1.9866,-2.5568,-3.2093,-3.9025,-4.5721,-5.1274,-5.4965,-5.7074,-5.8116,-5.8531,-5.8696,-5.8783,-5.8848,-5.8683,-5.7996,-5.6427,-5.3776,-5.0562,-4.7379,-4.4412,-4.1678,-3.894,-3.6025,-3.3286,-3.1063,-2.9133,-2.7152,-2.4855,-2.212,-1.9311,-1.6738,-1.402,-1.0765,-0.72423,-0.38849,-0.11168,0.071164,0.15354,0.15107,0.13947,0.18709,0.27286,0.36279,0.46081,0.57076,0.65823,0.69166,0.68903,0.67764,0.67231,0.68073,0.69442,0.70816,0.74576,0.82371,0.90016,0.93365,0.94265,0.95283,0.95877,0.95323,0.95267,0.97331,1.0067,1.0428,1.0909,1.1603,1.2415,1.3212,1.3878,1.4346,1.4724,1.511,1.5369,1.545,1.5839,1.6918,1.8079,1.8734,1.9339,2.0374,2.1369,2.1796,2.1846,2.1817,2.1719,2.1539,2.147,2.1672,2.1962,2.218,2.2618,2.3536,2.4655,2.5588,2.6093,2.6094,2.6053,2.6421,2.706,2.7744,2.8461,2.9224,2.9905,3.0331,3.0303,2.9727,2.8978,2.8436,2.8027,2.7602,2.7162,2.6736,2.6325,2.5907,2.5375,2.4632,2.3678,2.2556,2.1364,2.0177,1.8896,1.7455,1.608,1.5,1.4162,1.3431,1.2606,1.1549,1.0438,0.94489,0.84332,0.72573,0.61632,0.53888,0.47808,0.4179,0.37866,0.37786,0.38513,0.36957,0.34598,0.33208,0.3116,0.26735,0.21235,0.16618,0.14455,0.15579,0.1827,0.20711,0.23246,0.26332,0.28696,0.29039,0.27683,0.25388,0.23032,0.21359,0.20432,0.20262,0.21332,0.23978,0.27488,0.30775,0.32315,0.31175,0.29231,0.28096,0.25546,0.19999,0.16301,0.18722,0.22804,0.23895,0.25301,0.30266,0.33828,0.31257,0.26945,0.25789,0.25582,0.23493,0.21301,0.21349,0.23621,0.27223,0.30108,0.30619,0.29818,0.28782,0.25932,0.20273,0.15787,0.15926,0.17014,0.15426,0.14856,0.19028,0.24464,0.26919,0.26298,0.23732,0.2112,0.19734,0.17573,0.12979,0.08928,0.084972,0.10533,0.13153,0.15794,0.17886,0.1752,0.13632,0.098861,0.095396,0.095047,0.066809,0.042645,0.056798,0.089656,0.1143,0.12848,0.13613,0.14133,0.14466,0.1324,0.095256,0.055923,0.037405,0.032049,0.029282,0.0375,0.063269,0.086849,0.088667,0.076132,0.060419,0.040785,0.01552,-0.0090687,-0.02361,-0.014516,0.023344,0.057062,0.059071,0.061221,0.092505,0.11109,0.078065,0.03704,0.033298,0.036301,0.010958,-0.0202,-0.027771,-0.012465,0.015944,0.041523,0.051327,0.05049,0.046475,0.037959,0.023148,0.0071466,-0.0047723,-0.013574,-0.018182,-0.0031238,0.041439,0.088404,0.10937,0.1077,0.093405,0.071411,0.044812,0.014482,-0.017905,-0.04525,-0.058769,-0.04836,-0.011567,0.022158,0.027229,0.025421,0.039321,0.047394,0.027298,-0.0024059,-0.019592,-0.02879,-0.03603,-0.026702,0.0092167,0.042753,0.046007,0.034368,0.025529,0.0031265,-0.046326,-0.090731,-0.1007,-0.10326,-0.1241,-0.12709,-0.078709,-0.017679,0.012594,0.022123,0.027791,0.020516,-0.010987,-0.060866,-0.11492,-0.14269,-0.12338,-0.091113,-0.080737,-0.075075,-0.053005,-0.029651,-0.024228,-0.03607,-0.061374,-0.10369,-0.15998,-0.19351,-0.17164,-0.11184,-0.043351,0.0074644,0.024786,0.032083,0.049421,0.043968,-0.012446,-0.076456,-0.10077,-0.093929,-0.07507,-0.049826,-0.021578,0.0018049,0.012818,0.0099096,-0.0050393,-0.022366,-0.035739,-0.05993,-0.103,-0.12506,-0.086912,0])
    c=np.array([0,-0.033307,-0.024142,-0.095361,0.035552,0.091971,0.20419,0.052472,0.11404,0.071303,0.21287,0.12896,0.284,0.11021,0.24709,0.051012,0.23511,0.1966,0.27201,0.17046,0.091734,0.066221,0.018669,0.15369,0.067292,0.081058,0.033115,0.048287,0.091873,0.16637,0.21394,0.16171,0.037729,0.02018,0.055438,0.066595,0.056937,0.00878,0.0033157,-0.060588,0.024054,-0.024044,0.080066,0.0066444,-0.055311,-0.070488,-0.077098,0.030141,0.07018,-0.027405,-0.012646,-0.078087,0.051645,0.14491,0.14457,0.22908,0.27132,0.4813,0.79203,0.4756,-0.49916,-1.4633,-2.4909,-3.914,-5.2682,-5.7775,-5.8665,-5.8753,-5.9019,-5.7267,-5.0473,-4.4213,-3.9144,-3.2847,-2.9181,-2.5228,-1.9037,-1.4489,-0.71305,-0.04429,0.22011,0.085081,0.27639,0.44648,0.70252,0.69281,0.66045,0.69924,0.70912,0.9388,0.93667,0.97039,0.93442,1.008,1.0736,1.2429,1.404,1.4681,1.558,1.5216,1.8591,1.8893,2.1869,2.185,2.1808,2.1232,2.2083,2.2205,2.4801,2.6518,2.5684,2.7067,2.8408,3.0068,3.0745,2.8766,2.8061,2.7149,2.6317,2.5534,2.3801,2.1334,1.905,1.5838,1.408,1.2813,1.0304,0.86027,0.58847,0.48374,0.34507,0.40796,0.33385,0.33249,0.20581,0.11838,0.18798,0.22591,0.30314,0.2833,0.22465,0.20005,0.20107,0.27562,0.34569,0.2805,0.28614,0.10768,0.26123,0.21561,0.39438,0.23657,0.27604,0.19415,0.22543,0.32143,0.29532,0.28636,0.11517,0.20018,0.10494,0.27142,0.27721,0.19758,0.19967,0.058093,0.10363,0.15936,0.20656,0.065619,0.12413,0.0081253,0.099237,0.13286,0.14021,0.15431,0.036936,0.033486,0.021415,0.10585,0.076266,0.045878,-0.015064,-0.040034,0.088103,0.029994,0.15925,-0.00045197,0.0648,-0.040945,-0.022224,0.055055,0.051145,0.043307,0.0033855,-0.013969,-0.02895,0.11103,0.11527,0.074111,0.016757,-0.054248,-0.071267,0.049155,0.007595,0.07299,-0.015193,-0.026654,-0.050928,0.070155,0.026824,0.028757,-0.12309,-0.080781,-0.17337,0.011731,0.020371,0.039524,-0.055373,-0.18323,-0.067847,-0.092055,-0.014383,-0.028319,-0.088759,-0.23878,-0.11715,0.036342,0.016572,0.089866,-0.11223,-0.099693,-0.052576,0.011043,0.019233,-0.028519,-0.039352,-0.17365,-0.068834,0])
    order=4
    knots=np.array([1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61,63,65,67,69,71,73,75,77,79,81,83,85,87,89,91,93,95,97,99,101,103,105,107,109,111,113,115,117,119,121,123,125,127,129,131,133,135,137,139,141,143,145,147,149,151,153,155,157,159,161,163,165,167,169,171,173,175,177,179,181,183,185,187,189,191,193,195,197,199,201,203,205,207,209,211,213,215,217,219,221,223,225,227,229,231,233,235,237,239,241,243,245,247,249,251,253,255,257,259,261,263,265,267,269,271,273,275,277,279,281,283,285,287,289,291,293,295,297,299,301,303,305,307,309,311,313,315,317,319,321,323,325,327,329,331,333,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,377,379,381,383,385,387,389,391,393,395,397,399,401,403,405,407,409,411,413,415,417,419,421,423,425,427,429,431,433,435,437,439,441,443,445,447,449,451,453,455,457,459,461,463,465,467,469,471,473,475])
    i=2
    prd = predict_mse(psig,s,c,order,knots, i)
    assert round(prd, 7)==0.0002756