from Hermite.subsample import subsample
import numpy as np
import numpy.testing as npt


def test_1():
    sample = np.array([0,-0.033729,-0.036644,-0.085781,-0.042474,-0.076204,0.013325,0.056632,0.053717,0.12784,0.12492,0.091195,0.042058,0.05455,0.051635,0.033313,0.061213,0.073705,0.14783,0.067875,0.12659,0.13908,0.15157,0.11785,0.099523,0.081201,0.1091,0.075371,0.010827,0.054134,0.11285,0.094526,0.12243,0.13492,0.10119,0.1445,0.033729,0.015407,-0.018322,-0.052052,-0.054967,-0.1041,-0.076204,-0.048304,-0.051219,-0.0079119,-0.072456,-0.090778,-0.078286,-0.096608,-0.11493,-0.13325,-0.12076,-0.077453,-0.095775,-0.052468,0.0062462,-0.027483,0.015824,0.012909,-0.067043,-0.085365,-0.14991,-0.16823,-0.18655,-0.15865,-0.17698,-0.14908,-0.15199,-0.17031,-0.18864,-0.17614,-0.20987,-0.25901,-0.24652,-0.23402,-0.31398,-0.25526,-0.25818,-0.24568,-0.26401,-0.23611,-0.20821,-0.24194,-0.24485,-0.3094,-0.34312,-0.31523,-0.34895,-0.39809,-0.32397,-0.31148,-0.29898,-0.24027,-0.25859,-0.29232,-0.32605,-0.31356,-0.3627,-0.3502,-0.38393,-0.32522,-0.28191,-0.25401,-0.1953,-0.19821,-0.18572,-0.15782,-0.12992,-0.10202,-0.043307,0])
    tk = np.array([-560,-550,-540,-530,-520,-510,-500,-490,-480,-470,-460,-450,-440,-430,-420,-410,-400,-390,-380,-370,-360,-350,-340,-330,-320,-310,-300,-290,-280,-270,-260,-250,-240,-230,-220,-210,-200,-190,-180,-170,-160,-150,-140,-130,-120,-110,-100,-90,-80,-70,-60,-50,-40,-30,-20,-10,0,10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350,360,370,380,390,400,410,420,430,440,450,460,470,480,490,500,510,520,530,540,550])
    xk = np.array([-14.2437,-13.6725,-13.2015,-12.7825,-12.3973,-12.0363,-11.694,-11.3666,-11.0514,-10.7466,-10.4506,-10.1623,-9.88086,-9.6054,-9.33532,-9.0701,-8.80928,-8.55246,-8.29931,-8.04952,-7.80283,-7.55899,-7.31781,-7.07908,-6.84264,-6.60833,-6.376,-6.14553,-5.91678,-5.68965,-5.46404,-5.23984,-5.01697,-4.79534,-4.57487,-4.35549,-4.13711,-3.91969,-3.70314,-3.48741,-3.27244,-3.05818,-2.84456,-2.63154,-2.41907,-2.20709,-1.99557,-1.78444,-1.57368,-1.36323,-1.15305,-0.943095,-0.733327,-0.523703,-0.314181,-0.10472,0.10472,0.314181,0.523703,0.733327,0.943095,1.15305,1.36323,1.57368,1.78444,1.99557,2.20709,2.41907,2.63154,2.84456,3.05818,3.27244,3.48741,3.70314,3.91969,4.13711,4.35549,4.57487,4.79534,5.01697,5.23984,5.46404,5.68965,5.91678,6.14553,6.376,6.60833,6.84264,7.07908,7.31781,7.55899,7.80283,8.04952,8.29931,8.55246,8.80928,9.0701,9.33532,9.6054,9.88086,10.1623,10.4506,10.7466,11.0514,11.3666,11.694,12.0363,12.3973,12.7825,13.2015,13.6725,14.2437])
    y = subsample(sample, tk, xk)
    
    expected=np.array([-0.080363,-0.077262,-0.074533,-0.071981,-0.069536,-0.067164,-0.064844,-0.062565,-0.060317,-0.058095,-0.055895,-0.053713,-0.051547,-0.049397,-0.047265,-0.045151,-0.043059,-0.040988,-0.038942,-0.036922,-0.034929,-0.032965,-0.031031,-0.029129,-0.027261,-0.025427,-0.023629,-0.021868,-0.020147,-0.018466,-0.016827,-0.015231,-0.01368,-0.012174,-0.010717,-0.0093078,-0.0079493,-0.0066427,-0.0053893,-0.0041907,-0.0030483,-0.0019638,-0.00093857,2.5706e-05,0.00092746,0.0017651,0.0025368,0.0032411,0.0038762,0.0044402,0.0049314,0.005348,0.005688,0.0059494,0.0061303,0.0062287,0.0062424,0.0061722,0.0060214,0.0057933,0.0054913,0.0051187,0.0046787,0.0041745,0.0036093,0.0029863,0.0023086,0.0015793,0.00080169,-2.1205e-05,-0.00088622,-0.0017902,-0.0027299,-0.0037022,-0.0047037,-0.0057312,-0.0067814,-0.0078508,-0.0089359,-0.010033,-0.011139,-0.012249,-0.01336,-0.014468,-0.015569,-0.016657,-0.017729,-0.018779,-0.019803,-0.020795,-0.02175,-0.02266,-0.02352,-0.024322,-0.025058,-0.02572,-0.026298,-0.026781,-0.027158,-0.027414,-0.027535,-0.027512,-0.027338,-0.027007,-0.026513,-0.025843,-0.024983,-0.02391,-0.022592,-0.020972,-0.018943,-0.016227])
    npt.assert_array_almost_equal(y, expected, 5)